<?php
// Add custom order statuses to WooCommerce
function custom_woocommerce_order_statuses() {
    // Register "Shipping" status
    register_post_status('wc-shipping', array(
        'label'                     => 'Đang giao hàng', // Status name in Vietnamese
        'public'                    => true,
        'exclude_from_search'       => false,
        'show_in_admin_all_list'    => true,
        'show_in_admin_status_list' => true,
        'label_count'               => _n_noop('Đang giao hàng (%s)', 'Đang giao hàng (%s)', 'woocommerce'), // Translate plural form
    ));

    // Register "Packaging" status
    register_post_status('wc-packaging', array(
        'label'                     => 'Chuẩn bị giao VC', // Status name in Vietnamese
        'public'                    => true,
        'exclude_from_search'       => false,
        'show_in_admin_all_list'    => true,
        'show_in_admin_status_list' => true,
        'label_count'               => _n_noop('Chuẩn bị giao VC (%s)', 'Chuẩn bị giao VC (%s)', 'woocommerce'), // Translate plural form
    ));
}
add_action('init', 'custom_woocommerce_order_statuses');

// Add custom statuses to WooCommerce order status list
function add_custom_statuses_to_order_statuses($order_statuses) {
    $new_statuses = array();

    // Add each custom status to the WooCommerce order statuses list
    foreach ($order_statuses as $key => $status) {
        $new_statuses[$key] = $status;

        if ('wc-processing' === $key) { // Add after 'Processing'
            $new_statuses['wc-shipping'] = 'Đang giao hàng'; // Shipping status
            $new_statuses['wc-packaging'] = 'Chuẩn bị giao VC'; // Packaging status
        }
    }

    return $new_statuses;
}
add_filter('wc_order_statuses', 'add_custom_statuses_to_order_statuses');

// Add icons for custom statuses in admin (optional)
function custom_statuses_icons($status) {
    if ('wc-shipping' === $status) {
        echo '<span class="status-processing tips" data-tip="Đang giao hàng"></span>';
    }
    if ('wc-packaging' === $status) {
        echo '<span class="status-on-hold tips" data-tip="Chuẩn bị giao VC"></span>';
    }
}
add_action('woocommerce_admin_order_statuses', 'custom_statuses_icons');

